function CTe_Consulta_Carregar(n,t,i,r,u,f,e,o,s){s&&$("#"+n).keydown(function(s){eventoSearch=null;CTe_Consulta_Buscar(s,!0,n,t,i,r,u,f,e,o)});$("#"+t).click(function(s){eventoSearch=s;CTe_Consulta_Buscar(undefined,!1,n,t,i,r,u,f,e,o)})}function CTe_Consulta_Buscar(n,t,i,r,u,f,e,o,s,h){var l,c;if(n||t||i)if(idTxt=i,idBtn=r,urlBusca=f,campos=u,tituloBusca=e,colunasGrid=o,colunasEsconderGrid=s,closeSearchBox=h?!0:!1,n||(n=window.event),t){if(n.keyCode==9&&t){for(l={},l.inicioRegistros=0,c=0;c<campos.length;c++)l[campos[c].DescricaoBusca]=$("#CTe_Consulta_"+campos[c].Id).val(),c==0&&(l[campos[c].DescricaoBusca]=$("#"+idTxt).val()),l[campos[c].DescricaoBusca]==undefined&&(l[campos[c].DescricaoBusca]="");executarRest(urlBusca,l,CTe_Consulta_ResultadoBusca)}}else CTe_Consulta_Pesquisar(!0);else CTe_Consulta_Pesquisar(!1,undefined)}function CTe_Consulta_ResultadoBusca(n){if(n&&n.Sucesso){if(n.TotalRegistros==1&&colunasGrid.length==1){FecharDivBusca();fnCallback=colunasGrid[0].Evento;fnCallback!=undefined?fnCallback(n.Objeto[0]):jAlert("Ocorreu uma falha ao retornar os dados da busca. Atualize a página e tente novamente!","Falha ao Retornar os Dados");return}CTe_Consulta_Pesquisar(!0,n);return}jAlert("Ocorreu uma falha ao buscar os dados. Atualize a página e tente novamente!","Falha ao Buscar os Dados")}function CTe_Consulta_Pesquisar(n,t){var u,r,e,o,s,h,c,f,i;if(n){if($("#"+idDivBusca+"_"+idTxt).length<=0){for(u="",r=[],i=0;i<campos.length;i++)u+=campos.length==1?"<div class='field fieldtres'>":"<div class='field fielddois'>",u+="<div class='label'><label>"+campos[i].Descricao+":<\/label><\/div><div class='input'><input type='text' id='CTe_Consulta_"+campos[i].Id+"' /><\/div><\/div>",campos[i].Tipo!=undefined&&campos[i].Tipo!="text"&&r.push(campos[i]);for($("body").append(html.replace("#divsInputs#",u).replace("#divbusca#",idDivBusca+"_"+idTxt).replace("#idbtnbusca#",idBtnBusca+"_"+idTxt).replace("#iddivcontainergrid#",idDivContainerGrid+"_"+idTxt).replace("#iddivcontainerpaginacao#",idDivContainerPaginacao+"_"+idTxt).replace("#tituloPesquisa#",tituloBusca)),i=0;i<r.length;i++)switch(r[i].Tipo){case"date":$("#CTe_Consulta_"+r[i].Id).mask("99/99/9999");$("#CTe_Consulta_"+r[i].Id).datepicker({dateFormat:"dd/mm/yy",changeMonth:!0,changeYear:!0});break;case"phone":$("#CTe_Consulta_"+r[i].Id).mask("(99)? 999999999");$("#CTe_Consulta_"+r[i].Id).attr("onfocus","RemoverMascaraTelefone(this);");$("#CTe_Consulta_"+r[i].Id).attr("onblur","AdicionarMascaraTelefone(this);");break;case"decimal":$("#CTe_Consulta_"+r[i].Id).priceFormat({prefix:""});break;case"cpf_cnpj":$("#CTe_Consulta_"+r[i].Id).mask("99999999999?999");break;case"number":$("#CTe_Consulta_"+r[i].Id).mask("9?9999999999999999")}for(i=0;i<colunasGrid.length;i++)i==0?(e=colunasGrid[i].Evento,colunasGrid[i].Evento=function(n){CTe_Consulta_Escolheu(n,e)}):i==1?(o=colunasGrid[i].Evento,colunasGrid[i].Evento=function(n){CTe_Consulta_Escolheu(n,o)}):i==2?(s=colunasGrid[i].Evento,colunasGrid[i].Evento=function(n){CTe_Consulta_Escolheu(n,s)}):i==3?(h=colunasGrid[i].Evento,colunasGrid[i].Evento=function(n){CTe_Consulta_Escolheu(n,h)}):i==4&&(c=colunasGrid[i].Evento,colunasGrid[i].Evento=function(n){CTe_Consulta_Escolheu(n,c)});$("#"+idDivBusca+"_"+idTxt).dialog({autoOpen:!1,height:400,width:800,closeOnEscape:!1,modal:!0,draggable:!1,resizable:!1,zIndex:8120,close:function(){$("#"+idDivBusca+"_"+idTxt+" input:text").each(function(){try{$(this).val("")}catch(n){}})}})}AbrirDivBusca()}for(f={},f.inicioRegistros=0,i=0;i<campos.length;i++)f[campos[i].DescricaoBusca]=$("#CTe_Consulta_"+campos[i].Id).val();CriarGridView(urlBusca,f,idDivGrid+"_"+idTxt,idDivContainerGrid+"_"+idTxt,idDivContainerPaginacao+"_"+idTxt,colunasGrid,colunasEsconderGrid,t)}function CTe_Consulta_Escolheu(n,t){t!=undefined?(n!=undefined&&(n.data!=undefined?t(n.data,eventoSearch):t(n,eventoSearch)),FecharDivBusca()):jAlert("Ocorreu uma falha ao selecionar os dados. Atualize a página e tente novamente!","Atenção")}function AbrirDivBusca(){try{$("#"+idDivBusca+"_"+idTxt).dialog("open");campos.lengh>0&&$("#CTe_Consulta_"+campos[0].Id).focus()}catch(n){jAlert("Ocorreu uma falha ao tentar abrir a consulta. Atualize a página e tente novamente!","Atenção")}}function FecharDivBusca(){try{closeSearchBox&&$("#"+idDivBusca+"_"+idTxt).dialog("close")}catch(n){jAlert("Ocorreu uma falha ao tentar fechar a consulta. Atualize a página e tente novamente!","Atenção")}}function RemoveConsulta(n,t){n=$(n);typeof t!="function"&&(t=function(){});var i=function(n){n&&n.preventDefault&&n.preventDefault()};n.keydown(function(n){if(n.keyCode==8||n.keyCode==46||n.which==8||n.which==46)return t($(this));n.keyCode!=67&&n.which!=67&&n.ctrlKey==!0&&i(n)});n.keypress(function(n){i(n)});n.on("paste",function(n){i(n)});n.on("cut",function(n){i(n)})}var idDivBusca="CTe_Consulta_DivBox",idDivContainerGrid="CTe_Consulta_DivContainerGrid",idDivGrid="CTe_Consulta_DivGrid",idDivContainerPaginacao="CTe_Consuta_DivContainerPaginacao",idBtnBusca="CTe_Consulta_BtnBuscar",html="<div id='#divbusca#' title='#tituloPesquisa#'><div class='form'><div class='fields'><div class='fieldzao'>#divsInputs#<div class='field fieldum'><div class='buttons'><input type='button' id='#idbtnbusca#' value='Buscar' onclick='CTe_Consulta_Buscar()' /><\/div><\/div><\/div><\/div><\/div><div id='#iddivcontainergrid#' class='table' style='height: 265px; margin-left: 5px;'><\/div><div id='#iddivcontainerpaginacao#' class='pagination' style='margin-bottom: 0;'><\/div><\/div>",idTxt,idBtn,campos,urlBusca,tituloBusca,colunasGrid,colunasEsconderGrid,fnCallback,closeSearchBox,eventoSearch;