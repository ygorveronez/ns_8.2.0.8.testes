function CriarGridView(n,t,i,r,u,f,e,o,s){var a,c,h,l;if((n!=null||o!=null)&&ResetarPaginacao(),n){if(a="",document.location.pathname.split("/").length>1)for(c=document.location.pathname.split("/"),h=0;c.length-1>h;h++)c[h]!=""&&(a+="/"+c[h]);$("#"+r).data("urlConsulta",document.location.protocol+"//"+document.location.host+a+n)}t?$("#"+r).data("dadosJson",t):(l=$("#"+r).data("dadosJson"),l!=null&&(l.inicioRegistros=(paginaAtualServidor-1)*quantidadeRegistrosPagina,$("#"+r).data("dadosJson",l)));i&&$("#"+r).data("idTabela",i);u&&$("#"+r).data("divPaginacao",u);f&&$("#"+r).data("colunasAdicionais",f);e&&$("#"+r).data("colunasParaEsconder",e);s&&$("#"+r).data("agruparOpcoes",s);o?RenderizarTabela(o,r):$.ajax({type:"POST",url:$("#"+r).data("urlConsulta"),data:$("#"+r).data("dadosJson"),dataType:"jsonp",success:function(n){n&&n.SessaoExpirada&&(location.href="Logout.aspx");RenderizarTabela(n,r)},error:function(){location.href="Logon.aspx?ReturnUrl="+document.location.pathname}})}function RenderizarTabela(n,t){var u,e,f,i,r,o;if(n.Sucesso){u='<table id="'+$("#"+t).data("idTabela")+'" style="table-layout:fixed;"><thead><tr class="topoGrid">';for(e in n.Campos)f=n.Campos[e].split("|"),u+=f.length==2?"<th style='width:"+f[1]+"%;'>"+f[0]+"<\/th>":"<th>"+n.Campos[e]+"<\/th>";for(u+="<th class='jsonObject' style='display:none;'>Json Object Coluna<\/th>",u+="<\/tr><\/thead><tbody>",i=0;i<n.Objeto.length;i++){u+="<tr class='linha'>";for(r in n.Objeto[i])typeof n.Objeto[i][r]!="object"?(typeof n.Objeto[i][r]=="string"&&n.Objeto[i][r].indexOf("/Date(")>=0&&(o=jQuery.globalEval(n.Objeto[i][r].replace(/\/Date\((\d+)\)\//gi,"new Date($1)")),n.Objeto[i][r]=o.format("dd/MM/yyyy")),u+=typeof n.Objeto[i][r]!="number"?"<td title='"+n.Objeto[i][r]+"' style='overflow: hidden;text-overflow: ellipsis; white-space: nowrap;'>"+n.Objeto[i][r]+"<\/td>":"<td title='"+n.Objeto[i][r]+"' style='text-align:center;overflow: hidden;text-overflow: ellipsis; white-space: nowrap;'>"+n.Objeto[i][r]+"<\/td>"):u+="<td title='"+n.Objeto[i][r]+"' style='overflow: hidden;text-overflow: ellipsis; white-space: nowrap;'>"+n.Objeto[i][r]+"<\/td>";u+="<td class='jsonObject' style='display:none;'>"+JSON.stringify(n.Objeto[i])+"<\/td>";u+="<\/tr>"}u+="<\/tbody><\/table>";$("#"+t)[0].innerHTML=u;FormatarTabela(t,n.Objeto.length);CriarPaginacao(n.TotalRegistros,t)}else jAlert(n.Erro,"Erro")}function FormatarTabela(n,t){var u=$("#"+n).data("idTabela"),o=$("#"+n).data("agruparOpcoes"),f=$("#"+n).data("colunasParaEsconder"),s=$("#"+n).data("divPaginacao"),r,e,i;s?$("#"+u).dataTable({bPaginate:!0,bLengthChange:!1,bFilter:!1,bSort:!1,bInfo:!1,bAutoWidth:!1,iDisplayLength:quantidadeMostrar}):$("#"+u).dataTable({bPaginate:!1,bLengthChange:!1,bFilter:!1,bSort:!1,bInfo:!1,bAutoWidth:!1});r=$("#"+u).dataTable();for(e in f)r.fnSetColumnVis(f[e],!1,!0);if(paginaAtual>paginaAux)for(paginaAux=paginaAtual%5,i=paginaAux;i>1;i--)r.fnPageChange("next");if(jogarParaoUltimo&&(r.fnPageChange("last"),jogarParaoUltimo=!1,paginaAux=paginaAux-paginaAux%5,paginaAtual<paginaAux))for(i=paginaAtual;i<paginaAux;i++)r.fnPageChange("previous");t>0&&AdicionarColunas(!0,n,o)}function AdicionarColunas(n,t,i){return i?AdicionarColunasAgrupadas(n,t):AdicionarColunasSeparado(n,t)}function AdicionarColunasSeparado(n,t){var i=$("#"+t).data("idTabela"),u=$("#"+t).data("colunasAdicionais"),o=$("#"+i+" thead tr th").length,s=$("#"+i+" tbody tr:eq(0) td").length,f,r,e,h;if(n==!0||s!=o)for(f in u)r=document.createElement("td"),r.className="opcoes",r.innerHTML="<a>"+u[f].Descricao+"<\/a>",n&&(e=document.createElement("th"),e.innerHTML="Opções",$("#"+i+" thead tr").each(function(){this.appendChild(e)})),h=$("#"+i).dataTable(),$("#"+i+" tbody tr").each(function(){var n=r.cloneNode(!0),t=JSON.parse($(this).find("td[class='jsonObject']").html());$(n).bind("click",t,u[f].Evento);this.appendChild(n)})}function AdicionarColunasAgrupadas(n,t){var r=$("#"+t).data("idTabela"),u=$("#"+t).data("colunasAdicionais"),o=$("#"+r+" thead tr th").length,s=$("#"+r+" tbody tr:eq(0) td").length,h,f,i,e;(n==!0||s!=o)&&(h=100-$("#"+t).data("tamanhoTotalColunas"),f=document.createElement("td"),f.setAttribute("style","text-overflow: ellipsis; white-space: nowrap;"),n&&(i=document.createElement("th"),i.innerHTML="Opções",i.style.width="3%",i.style.maxWidth="100px",i.style.overflow="hidden",i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap",$("#"+r+" thead tr").each(function(){this.appendChild(i)})),u!=null&&(u.length==1?(e=$("#"+r).dataTable(),$("#"+r+" tbody tr").each(function(){var i=JSON.parse($(this).find("td[class='jsonObject']").html()),n=document.createElement("button"),t;n.type="button";n.className="btn btn-default btn-xs btn-block";n.innerHTML=u[0].Descricao;$(n).bind("click",i,u[0].Evento);t=f.cloneNode(!0);t.appendChild(n);this.appendChild(t)})):(e=$("#"+r).dataTable(),$("#"+r+" tbody tr").each(function(){var n=document.createElement("ul"),e,t,i,o;n.className="dropdown-menu";n.style.left="auto";n.style.right="0";n.setAttribute("role","menu");for(e in u){var h=JSON.parse($(this).find("td[class='jsonObject']").html()),s=document.createElement("li"),r=document.createElement("a");r.innerHTML=u[e].Descricao;r.style.cursor="pointer";$(r).bind("click",h,u[e].Evento);s.appendChild(r);n.appendChild(s)}t=document.createElement("button");t.className="btn btn-default btn-xs btn-block dropdown-toggle text-right";t.type="button";t.setAttribute("data-toggle","dropdown");t.innerHTML='<span class="menu-list"><span class="bar"><\/span><span class="bar"><\/span><span class="bar"><\/span><\/span> <span class="caret"><\/span>';i=document.createElement("div");i.className="btn-group btn-block";i.appendChild(t);i.appendChild(n);o=f.cloneNode(!0);o.appendChild(i);this.appendChild(o)}))))}function ResetarPaginacao(){paginaAtual=1;paginaAtualServidor=1;paginaAux=undefined}function CriarPaginacao(n,t){var u=$("#"+t).data("idTabela"),r=Math.ceil(n/quantidadeMostrar),i="<span>";i+="<label>Mostrando "+paginaAtual+" de "+r+"<\/label>";paginaAtual!=1?(i+='<a href="javascript:Paginar('+n+", 1, '"+t+"');\">Primeiro<\/a>",i+='<a href="javascript:Paginar('+n+", "+(paginaAtual-1)+", '"+t+"');\">Anterior<\/a>"):(i+='<a href="#" class="aspNetDisabled">Primeiro<\/a>',i+='<a href="#" class="aspNetDisabled">Anterior<\/a>');i+=CriarListaPaginas(r,n,t);paginaAtual+1<=r?(i+='<a href="javascript:Paginar('+n+", "+(paginaAtual+1)+", '"+t+"');\">Próximo<\/a>",i+='<a href="javascript:Paginar('+n+", "+r+", '"+t+"');\">Último<\/a>"):(i+='<a href="#" class="aspNetDisabled">Próximo<\/a>',i+='<a href="#" class="aspNetDisabled">Último<\/a>');i+="<\/span>";$("#"+$("#"+t).data("divPaginacao")).html(i)}function CriarListaPaginas(n,t,i){var u="",e=paginaAtual-2,f,r;if(n==1)u='<span class="current">1<\/span>';else for(f=0,r=e;f<5&&r<=n;r++)r>0&&(f++,u+=r==paginaAtual?'<span class="current">'+paginaAtual+"<\/span>":'<a href="javascript:Paginar('+t+", "+r+", '"+i+"');\">"+r+"<\/a>");return u}function Paginar(n,t,i){var f=$("#"+i).data("idTabela"),e=$("#"+i).data("agruparOpcoes"),o=Math.ceil(n/quantidadeMostrar),s=Math.ceil(n/quantidadeRegistrosPagina),u,r;if(paginaAux=paginaAtual,t>paginaAtual)if(paginaAtual=t,quantidadeRegistrosPagina*paginaAtualServidor>=paginaAtual*quantidadeMostrar){for(oTable=$("#"+f).dataTable(),u=paginaAux;u<paginaAtual;u++)oTable.fnPageChange("next");CriarPaginacao(n,i);AdicionarColunas(!1,i,e)}else r=quantidadeRegistrosPagina/quantidadeMostrar,r=paginaAtual/r,paginaAtualServidor=Math.ceil(r),paginaAtual==o&&(jogarParaoUltimo=!0),CriarGridView(null,null,null,i);else if(paginaAtual=t,quantidadeRegistrosPagina*paginaAtualServidor-paginaAtual*quantidadeMostrar<quantidadeRegistrosPagina){for(oTable=$("#"+f).dataTable(),u=paginaAux;u>paginaAtual;u--)oTable.fnPageChange("previous");CriarPaginacao(n,i);AdicionarColunas(!1,i,e)}else jogarParaoUltimo=!0,r=quantidadeRegistrosPagina/quantidadeMostrar,r=paginaAtual/r,paginaAtualServidor=Math.ceil(r),CriarGridView(null,null,null,i)}var paginaAtual=1,paginaAux,paginaAtualServidor=1,quantidadeRegistrosPagina=50,quantidadeMostrar=10,jogarParaoUltimo=!1;