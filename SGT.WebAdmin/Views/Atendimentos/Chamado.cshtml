
<ol class="breadcrumb page-breadcrumb">
    <li class="breadcrumb-item">Atendimentos</li>
    <li class="breadcrumb-item active">Chamado</li>
</ol>

<div class="subheader">
    <h1 class="subheader-title">
        <i class=""></i> Chamados
    </h1>
</div>

<div id="knockoutPesquisaChamado">
    <div class="panel">
        <div class="panel-container">
            <div class="panel-content">
                <button class="btn btn-primary waves-effect waves-themed" data-bind="click: ExibirFiltros.eventClick, id: ExibirFiltros.id">
                    <i class="fal fa-search"></i>
                    Pesquisar Chamados
                </button>

                <div class="mt-3" data-bind="id: ExibirFiltros.idFade, fadeVisible: ExibirFiltros.visibleFade">
                    <form>
                        <div class="row">
                            <div class="col-12 col-md-4" data-bind="visible: MotivoProblema.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: MotivoProblema.text"></label>
                                    <input type="text" class="form-control" data-bind="value: MotivoProblema.val, attr: { maxlength: MotivoProblema.maxlength, id : MotivoProblema.id} , valueUpdate: 'afterkeydown'" />
                                </div>
                            </div>
                            <div class="col-12 col-md-4" data-bind="visible: Titulo.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: Titulo.text"></label>
                                    <input type="text" class="form-control" data-bind="value: Titulo.val, valueUpdate: 'afterkeydown', attr: { maxlength: Titulo.maxlength, id : Titulo.id}" />
                                </div>
                            </div>
                            <div class="col-12 col-md-2" data-bind="visible: Prioridade.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: Prioridade.text"></label>
                                    <select class="form-control" data-bind="options: Prioridade.options, enable: Prioridade.enable, optionsText: 'text', optionsValue: 'value', value: Prioridade.val, attr: { id : Prioridade.id}"></select>
                                </div>
                            </div>
                            <div class="col-12 col-md-2" data-bind="visible: Status.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: Status.text"></label>
                                    <select class="form-control" data-bind="options: Status.options, optionsText: 'text', optionsValue: 'value', selectedOptions: Status.val, attr: { id : Status.id}" multiple="multiple" data-actions-box="false" data-selected-text-format="count > 2" title="Todos"></select>
                                </div>
                            </div>
                            <div class="col-12 col-md-2" data-bind="visible: NumeroInicial.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: NumeroInicial.text"></label>
                                    <input type="text" class="form-control" data-bind="value: NumeroInicial.val, valueUpdate: 'afterkeydown', attr: { maxlength: NumeroInicial.maxlength, id : NumeroInicial.id}" />
                                </div>
                            </div>
                            <div class="col-12 col-md-2" data-bind="visible: NumeroFinal.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: NumeroFinal.text"></label>
                                    <input type="text" class="form-control" data-bind="value: NumeroFinal.val, valueUpdate: 'afterkeydown', attr: { maxlength: NumeroFinal.maxlength, id : NumeroFinal.id}" />
                                </div>
                            </div>
                            <div class="col-12 col-md-2" data-bind="visible: DataInicial.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: DataInicial.text"></label>
                                    <input type="text" class="form-control" data-bind="value: DataInicial.val, valueUpdate: 'afterkeydown', attr: { maxlength: DataInicial.maxlength, id : DataInicial.id}" />
                                </div>
                            </div>
                            <div class="col-12 col-md-2" data-bind="visible: DataFinal.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: DataFinal.text"></label>
                                    <input type="text" class="form-control" data-bind="value: DataFinal.val, valueUpdate: 'afterkeydown', attr: { maxlength: DataFinal.maxlength, id : DataFinal.id}" />
                                </div>
                            </div>
                            <div class="col-12 col-md-4" data-bind="visible: Solicitante.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: Solicitante.text, attr: { for: Solicitante.id }"></label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" data-bind="css: Solicitante.requiredClass, value: Solicitante.val, valueUpdate: 'afterkeydown', attr: { maxlength: Solicitante.maxlength, id : Solicitante.id}" />
                                        <div class="input-group-append">
                                            <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Solicitante.idBtnSearch}" type="button" aria-label="Buscar">
                                                <i class="fal fa-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-4" data-bind="visible: Tela.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: Tela.text, attr: { for: Tela.id }"></label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" data-bind="css: Tela.requiredClass, value: Tela.val, valueUpdate: 'afterkeydown', attr: { maxlength: Tela.maxlength, id : Tela.id}" />
                                        <div class="input-group-append">
                                            <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Tela.idBtnSearch}" type="button" aria-label="Buscar">
                                                <i class="fal fa-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-4" data-bind="visible: Modulo.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: Modulo.text, attr: { for: Modulo.id }"></label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" data-bind="css: Modulo.requiredClass, value: Modulo.val, valueUpdate: 'afterkeydown', attr: { maxlength: Modulo.maxlength, id : Modulo.id}" />
                                        <div class="input-group-append">
                                            <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Modulo.idBtnSearch}" type="button" aria-label="Buscar">
                                                <i class="fal fa-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-4" data-bind="visible: Sistema.visible">
                                <div class="form-group">
                                    <label class="form-label" data-bind="text: Sistema.text, attr: { for: Sistema.id }"></label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" data-bind="css: Sistema.requiredClass, value: Sistema.val, valueUpdate: 'afterkeydown', attr: { maxlength: Sistema.maxlength, id : Sistema.id}" />
                                        <div class="input-group-append">
                                            <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Sistema.idBtnSearch}" type="button" aria-label="Buscar">
                                                <i class="fal fa-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="d-flex align-items-center justify-content-end mb-3">
                        <button class="btn btn-primary waves-effect waves-themed btnPesquisarFiltroPesquisa" data-bind="click: Pesquisar.eventClick, attr: { id: Pesquisar.id}" type="button">
                            <i class="fal fa-search"></i><span data-bind="text: Pesquisar.text"></span>
                        </button>
                    </div>
                    <table width="100%" class="table table-bordered table-hover" data-bind="attr: { id: Pesquisar.idGrid}" cellspacing="0"></table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="panel">
    <div class="panel-container">
        <div class="panel-content">
            <ul class="nav nav-tabs" id="knockoutEtapaChamado">
                <li class="nav-item">
                    <a href="#step1" class="nav-link active" data-bs-toggle="tab"><span class="hidden-mobile hidden-tablet" data-bind="text: Etapa1.text"></span></a>
                </li>
                <li class="nav-item">
                    <a href="#step2" class="nav-link" data-bs-toggle="tab"><span class="hidden-mobile hidden-tablet" data-bind="text: Etapa2.text"></span></a>
                </li>
                <li class="nav-item">
                    <a href="#step3" class="nav-link" data-bs-toggle="tab"><span class="hidden-mobile hidden-tablet" data-bind="text: Etapa3.text"></span></a>
                </li>
            </ul>
            <div class="tab-content border border-top-0 p-3">
                <!-- Chamado-->
                <div id="step1" class="tab-pane fade active show">
                    <div class="row" id="knockoutChamado">
                        <div class="col-12 col-md-12" data-bind="visible: Empresa.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Empresa.text, attr: { for: Empresa.id }"></label>
                                <div class="input-group">
                                    <input type="text" class="form-control" data-bind="css: Empresa.requiredClass, enable: Empresa.enable, value: Empresa.val, valueUpdate: 'afterkeydown', attr: { maxlength: Empresa.maxlength, id : Empresa.id}" />
                                    <div class="input-group-append">
                                        <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Empresa.idBtnSearch}" type="button" aria-label="Buscar">
                                            <i class="fal fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-8" data-bind="visible: Titulo.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Titulo.text"></label>
                                <input type="text" class="form-control" data-bind="css: Titulo.requiredClass, value: Titulo.val, valueUpdate: 'afterkeydown', attr: { maxlength: Titulo.maxlength, id : Titulo.id}" />
                            </div>
                        </div>
                        <div class="col-12 col-md-2" data-bind="visible: Numero.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Numero.text"></label>
                                <input type="text" class="form-control" data-bind="value: Numero.val, enable: Numero.enable, valueUpdate: 'afterkeydown', attr: { maxlength: Numero.maxlength, id : Numero.id}" />
                            </div>
                        </div>
                        <div class="col-12 col-md-2" data-bind="visible: Data.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Data.text"></label>
                                <input type="text" class="form-control" data-bind="value: Data.val, enable: Data.enable, valueUpdate: 'afterkeydown', attr: { maxlength: Data.maxlength, id : Data.id}" />
                            </div>
                        </div>
                        <div class="col-12 col-md-4" data-bind="visible: Solicitante.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Solicitante.text, attr: { for: Solicitante.id }"></label>
                                <div class="input-group">
                                    <input type="text" class="form-control" data-bind="css: Solicitante.requiredClass, value: Solicitante.val, valueUpdate: 'afterkeydown', attr: { maxlength: Solicitante.maxlength, id : Solicitante.id}" />
                                    <div class="input-group-append">
                                        <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Solicitante.idBtnSearch}" type="button" aria-label="Buscar">
                                            <i class="fal fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-4" data-bind="visible: Tela.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Tela.text, attr: { for: Tela.id }"></label>
                                <div class="input-group">
                                    <input type="text" class="form-control" data-bind="css: Tela.requiredClass, value: Tela.val, valueUpdate: 'afterkeydown', attr: { maxlength: Tela.maxlength, id : Tela.id}" />
                                    <div class="input-group-append">
                                        <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Tela.idBtnSearch}" type="button" aria-label="Buscar">
                                            <i class="fal fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-4" data-bind="visible: Modulo.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Modulo.text, attr: { for: Modulo.id }"></label>
                                <div class="input-group">
                                    <input type="text" class="form-control" data-bind="css: Modulo.requiredClass, value: Modulo.val, valueUpdate: 'afterkeydown', attr: { maxlength: Modulo.maxlength, id : Modulo.id}" />
                                    <div class="input-group-append">
                                        <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Modulo.idBtnSearch}" type="button" aria-label="Buscar">
                                            <i class="fal fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-4" data-bind="visible: Sistema.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Sistema.text, attr: { for: Sistema.id }"></label>
                                <div class="input-group">
                                    <input type="text" class="form-control" data-bind="css: Sistema.requiredClass, value: Sistema.val, valueUpdate: 'afterkeydown', attr: { maxlength: Sistema.maxlength, id : Sistema.id}" />
                                    <div class="input-group-append">
                                        <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: Sistema.idBtnSearch}" type="button" aria-label="Buscar">
                                            <i class="fal fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-4" data-bind="visible: TipoAtendimento.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: TipoAtendimento.text, attr: { for: TipoAtendimento.id }"></label>
                                <div class="input-group">
                                    <input type="text" class="form-control" data-bind="css: TipoAtendimento.requiredClass, value: TipoAtendimento.val, valueUpdate: 'afterkeydown', attr: { maxlength: TipoAtendimento.maxlength, id : TipoAtendimento.id}" />
                                    <div class="input-group-append">
                                        <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: TipoAtendimento.idBtnSearch}" type="button" aria-label="Buscar">
                                            <i class="fal fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-2" data-bind="visible: Prioridade.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Prioridade.text, attr: { for: Prioridade.id }"></label>
                                <select class="form-control" data-bind="options: Prioridade.options, enable: Prioridade.enable, optionsText: 'text', optionsValue: 'value', value: Prioridade.val, attr: { id : Prioridade.id}"></select>
                            </div>
                        </div>
                        <div class="col-12 col-md-2" data-bind="visible: Status.visible, enable: Status.enable">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Status.text, attr: { for: Status.id }"></label>
                                <select class="form-control" data-bind="options: Status.options, enable: Status.enable, optionsText: 'text', optionsValue: 'value', value: Status.val, attr: { id : Status.id}"></select>
                            </div>
                        </div>
                        <div class="col-12 col-md-12" data-bind="visible: MotivoProblema.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: MotivoProblema.text, attr: { for: MotivoProblema.id }"></label>
                                <textarea class="form-control" rows="5" data-bind="css: MotivoProblema.requiredClass, value: MotivoProblema.val, enable: MotivoProblema.enable, attr: { maxlength: MotivoProblema.maxlength, id : MotivoProblema.id}"></textarea>
                            </div>
                        </div>
                        <div class="col-12 col-md-12" data-bind="visible: Observacao.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Observacao.text, attr: { for: Observacao.id }"></label>
                                <textarea class="form-control" rows="5" data-bind="value: Observacao.val, enable: Observacao.enable, attr: { maxlength: Observacao.maxlength, id : Observacao.id}"></textarea>
                            </div>
                        </div>
                        <footer>
                            <div class="row">
                                <div class="col-6">
                                    <button type="button" class="btn btn-labeled btn-default" data-bind="click: Cancelar.eventClick, visible: Cancelar.visible, attr: { value: Cancelar.text, id : Cancelar.id}">
                                        <i class="fal fa-ban"></i>
                                        <span data-bind="text: Cancelar.text"></span>
                                    </button>
                                </div>
                                <div class="col-6 d-flex justify-content-end">
                                    <button type="button" class="btn btn-labeled btn-success" data-bind="click: Atualizar.eventClick, visible: Atualizar.visible, attr: { value: Atualizar.text, id : Atualizar.id}">
                                        <i class="fal fa-check"></i>
                                        <span data-bind="text: Atualizar.text"></span>
                                    </button>
                                    <button type="button" class="btn btn-labeled btn-success" data-loading-text="Aguarde..." data-bind="click: Adicionar.eventClick, visible: Adicionar.visible, attr: { value: Adicionar.text, id : Adicionar.id}">
                                        <span data-bind="text: Adicionar.text"></span>
                                    </button>
                                </div>
                            </div>
                        </footer>
                    </div>
                </div>

                <!-- Anexos -->
                <div id="step2" class="tab-pane fade">
                    <div class="row" id="knockoutAnexosChamado">
                        <div class="col-12 col-md-4" data-bind="visible: DescricaoAnexo.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: DescricaoAnexo.text"></label>
                                <input type="text" class="form-control" data-bind="css: DescricaoAnexo.requiredClass, value: DescricaoAnexo.val, enable: DescricaoAnexo.enable, attr: { maxlength: DescricaoAnexo.maxlength, id : DescricaoAnexo.id} , valueUpdate: 'afterkeydown'" />
                            </div>
                        </div>
                        <div class="form-group col-12 col-md-4" data-bind="visible: Arquivo.visible">
                            <p class="form-label" data-bind="text: Arquivo.text"></p>
                            <div class="custom-file-btn" data-bind="visible: Arquivo.visible">
                                <input type="file" class="custom-file-input" data-bind="value: Arquivo.val, attr: {id: Arquivo.id}" readonly>
                                <label class="custom-file-label" data-bind="attr: {for: Arquivo.id}, text: Arquivo.val() !=``? Arquivo.val(): `Selecione um arquivo para anexar`"></label>
                            </div>
                        </div>
                        <div class="col-12 d-flex justify-content-end mb-3" data-bind="visible: SalvarAnexo.visible">
                            <button type="button" class="btn btn-labeled btn-success" data-bind="click: SalvarAnexo.eventClick, attr: { id: SalvarAnexo.id}, enable: SalvarAnexo.enable">
                                <i class="fal fa-save"></i>
                                <span data-bind="text: SalvarAnexo.text"></span>
                            </button>
                        </div>
                        <table width="100%" class="table table-bordered table-hover" data-bind="attr: {id: AnexosChamado.id}, enable: AnexosChamado.enable" cellspacing="0"></table>
                    </div>
                </div>

                <!-- Respostas -->
                <div id="step3" class="tab-pane fade">
                    <div class="row" id="knockoutRespostasChamado">
                        <div class="col-12 col-md-12" data-bind="visible: Resposta.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: Resposta.text, attr: { for: Resposta.id }"></label>
                                <textarea class="form-control" rows="3" data-bind="css: Resposta.requiredClass, value: Resposta.val, valueUpdate: 'afterkeydown', attr: { maxlength: Resposta.maxlength, id : Resposta.id}"></textarea>
                            </div>
                        </div>
                        <div class="col-12 col-md-4" data-bind="visible: FuncionarioResposta.visible">
                            <div class="form-group">
                                <label class="form-label" data-bind="text: FuncionarioResposta.text, attr: { for: FuncionarioResposta.id }"></label>
                                <div class="input-group">
                                    <input type="text" class="form-control" data-bind="css: FuncionarioResposta.requiredClass, value: FuncionarioResposta.val, valueUpdate: 'afterkeydown', attr: { maxlength: FuncionarioResposta.maxlength, id : FuncionarioResposta.id}" />
                                    <div class="input-group-append">
                                        <button class="btn btn-primary waves-effect waves-themed" data-bind="attr: { id: FuncionarioResposta.idBtnSearch}" type="button" aria-label="Buscar">
                                            <i class="fal fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 d-flex justify-content-end mb-3" data-bind="visible: SalvarResposta.visible">
                            <button type="button" class="btn btn-labeled btn-success" data-bind="click: SalvarResposta.eventClick, attr: { id: SalvarResposta.id}, enable: SalvarResposta.enable">
                                <i class="fal fa-save"></i>
                                <span data-bind="text: SalvarResposta.text"></span>
                            </button>
                        </div>
                        <table width="100%" class="table table-bordered table-hover" data-bind="attr: {id: RespostasChamado.id}, enable: RespostasChamado.enable" cellspacing="0"></table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/scripts/chamado"></script>
<script src="~/scripts/webcam"></script>
<script type="text/javascript">
    pageSetUp();

    $(document).ready(function () {        
        LoadLocalizationResources(["Cargas.Carga", "Chamado.ChamadoOcorrencia", "Cargas.ControleEntrega", "Ocorrencias.AutorizacaoOcorrencia"]).then(function () {
            loadChamado();
        });
    });

</script>

