<div class="modal fade" id="divModalChatMotorista" tabindex="-1" aria-hidden="true">
    <div id="KnoutChatModal" class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">

            <!-- Cabeçalho -->
            <div class="modal-header">
                <h5 class="modal-title">Chat</h5>
                <!-- Botão de fechar (Bootstrap 5) -->
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Corpo: lista de mensagens -->
            <div class="modal-body" style="background: #FFF;">

                <div id="chatScrollContainer"
                     style="height: 400px; overflow-y: auto; position: relative; padding:10px;">

                    <ul id="chatMessagesContainer" style="list-style:none; margin:0; padding:0;"></ul>

                </div>
            </div>
            <!-- Rodapé -->
            <div class="modal-footer" style="flex-wrap: wrap;">

                <div style="width: 100%; margin-bottom: 6px;">
                    <label style="font-weight: 600;">Mensagem</label>
                </div>

                <!-- Caixa com anexo + campo de texto -->
                <div style="
                     width: 100%;
                     border:1px solid #ccc;
                     border-radius:4px;
                     padding:8px;
                     margin-bottom:8px;
                ">
                    <!-- Exibe anexo se houver -->
                    <div data-bind="if: NovaMensagemAnexoNome.val">
                        <span style="font-size:0.85em; font-weight:bold;">ANEXOS:</span>
                        <span style="
                            display:inline-block;
                            background: #555;
                            color: #fff;
                            padding: 2px 8px;
                            border-radius: 4px;
                            margin-left:4px;"
                              data-bind="text: NovaMensagemAnexoNome.val">
                        </span>

                        <!-- Botão "X" para remover anexo -->
                        <button data-bind="click: RemoverAnexo.eventClick"
                                class="btn btn-sm btn-danger"
                                style="margin-left: 6px;
                                        background: #555;
                                        color: #fff;
                                        border-radius: 4px;">
                            &times;
                        </button>
                    </div>

                    <!-- Campo de texto -->
                    <input type="text"
                           class="form-control"
                           data-bind="value: NovaMensagem.val"
                           placeholder="Digite sua mensagem..."
                           style="margin-top:8px;" />
                </div>

                <!-- Linha de botões (Anexo à esquerda, demais à direita) -->
                <div class="d-flex w-100 align-items-center justify-content-end">

                    <!-- Botão "Anexo" -->
                    <button class="btn btn-secondary me-auto"
                            data-bind="visible: AdicionarAnexo.visible,
                     click: AdicionarAnexo.eventClick">
                        <i class="fa fa-paperclip"></i> Anexo
                    </button>

                    <!-- Input file oculto -->
                    <input type="file" id="fileAnexo" style="display:none;"
                           data-bind="event: { change: OnFileChange }" />

                    <!-- Botão "Marcar como não lido" -->
                    <button class="btn btn-default me-2"
                            data-bind="click: MarcarComoNaoLido.eventClick">
                        Marcar como não lido
                    </button>

                    <!-- Botão "Atualizar" -->
                    <button class="btn btn-default me-2"
                            data-bind="click: Atualizar.eventClick">
                        Atualizar
                    </button>

                    <!-- Botão "Enviar" -->
                    <button class="btn btn-primary"
                            data-bind="click: EnviarMensagem.eventClick">
                        Enviar
                    </button>

                </div>
            </div>

        </div>
    </div>
</div>

<!-- CSS dos "balões" -->
<style>
    .balao-me .balao-container {
        background-color: #E8F7FE; 
        border-radius: 8px;
        padding: 10px;
        max-width: 357px;
        margin-left: auto;
        margin-right: 0;
        margin-top: 5px;
    }

    .balao-outro .balao-container {
        background-color: #FFD79C;
        border-radius: 8px;
        padding: 10px;
        max-width: 357px;
        margin-right: auto;
        margin-left: 0;
        margin-top: 5px;
    }
</style>
