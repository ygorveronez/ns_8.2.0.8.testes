(function(n){n.fn.visualize=function(t,i){return n(this).each(function(){function g(){var i=u.colors,t=u.textColors;return{dataGroups:function(){var f=[],o,r;if(u.parseDirection=="x")e.find("tr:gt(0)").each(function(r){f[r]={},f[r].points=[],f[r].color=i[r],t[r]&&(f[r].textColor=t[r]),n(this).find("td").each(function(){f[r].points.push(parseInt(n(this).text(),10))})});else for(o=e.find("tr:eq(1) td").size(),r=0;r<o;r++)f[r]={},f[r].points=[],f[r].color=i[r],t[r]&&(f[r].textColor=t[r]),e.find("tr:gt(0)").each(function(){f[r].points.push(n(this).find("td").eq(r).text()*1)});return f},allData:function(){var t=[];return n(this.dataGroups()).each(function(){t.push(this.points)}),t},dataSum:function(){var t=0,i=this.allData().join(",").split(",");return n(i).each(function(){t+=parseInt(this,10)}),t},topValue:function(){var t=0,i=this.allData().join(",").split(",");return n(i).each(function(){parseInt(this,10)>t&&(t=parseInt(this,10))}),t},bottomValue:function(){var t=0,i=this.allData().join(",").split(",");return n(i).each(function(){this<t&&(t=parseInt(this,10))}),t},memberTotals:function(){var i=[],t=this.dataGroups();return n(t).each(function(r){var u=0;n(t[r].points).each(function(n){u+=t[r].points[n]}),i.push(u)}),i},yTotals:function(){for(var i=[],u=this.dataGroups(),f=this.xLabels().length,r,t=0;t<f;t++)i[t]=[],r=0,n(u).each(function(){i[t].push(this.points[t])}),i[t].join(",").split(","),n(i[t]).each(function(){r+=parseInt(this)}),i[t]=r;return i},topYtotal:function(){var t=0,i=this.yTotals().join(",").split(",");return n(i).each(function(){parseInt(this,10)>t&&(t=parseInt(this,10))}),t},totalYRange:function(){return this.topValue()+Math.abs(this.bottomValue())},xLabels:function(){var t=[];return u.parseDirection=="x"?e.find("tr:eq(0) th").each(function(){t.push(n(this).html())}):e.find("tr:gt(0) th").each(function(){t.push(n(this).html())}),t},yLabels:function(){for(var n=[],i=u.height,r=Math.round(i/30),f=Math.round(this.totalYRange()/Math.floor(r)),t=this.bottomValue();t<=w;t+=f)n.push(t);return n[n.length-1]!=this.topValue()&&(n.pop(),n.push(this.topValue())),n}}}var u=n.extend({type:"bar",width:n(this).width(),height:n(this).height(),appendTitle:!0,title:null,appendKey:!0,colors:["#be1e2d","#666699","#92d5ea","#ee8310","#8d10ee","#5a3b16","#26a4ed","#f45a90","#e9e744"],textColors:[],parseDirection:"x",pieMargin:20,pieLabelPos:"inside",lineWeight:4,barGroupMargin:10,barMargin:1},t),e,v,k,y,d,r;u.width=parseInt(u.width,10),u.height=parseInt(u.height,10),e=n(this);var p={pie:function(){h.addClass("visualize-pie"),u.pieLabelPos=="outside"&&h.addClass("visualize-pie-outside");var i=Math.round(f.width()/2),t=Math.round(f.height()/2),e=t-u.pieMargin,o=0,l=function(n){return Math.PI/180*n},c=n('<ul class="visualize-labels"><\/ul>').insertAfter(f);n.each(it,function(f){var l=this<0?0:this/tt;r.beginPath(),r.moveTo(i,t),r.arc(i,t,e,o*Math.PI*2-Math.PI*.5,(o+l)*Math.PI*2-Math.PI*.5,!1),r.lineTo(i,t),r.closePath(),r.fillStyle=s[f].color,r.fill();var a=o+l/2,v=u.pieLabelPos=="inside"?e/1.5:e+e/5,y=Math.round(i+Math.sin(a*Math.PI*2)*v),p=Math.round(t-Math.cos(a*Math.PI*2)*v),w=y>i?"right":"left",b=p>t?"bottom":"top",h=n('<span class="visualize-label">'+Math.round(l*100)+"%<\/span>").css(w,0).css(b,0),k=n('<li class="visualize-label-pos"><\/li>').appendTo(c).css({left:y,top:p}).append(h);h.css("font-size",e/8).css("margin-"+w,-h.width()/2).css("margin-"+b,-h.outerHeight()/2),s[f].textColor&&h.css("color",s[f].textColor),o+=l})},line:function(t){var i,e;t?h.addClass("visualize-area"):h.addClass("visualize-line"),i=f.width()/(l.length-1),e=n('<ul class="visualize-labels-x"><\/ul>').width(f.width()).height(f.height()).insertBefore(f),n.each(l,function(t){var f=n("<li><span>"+this+"<\/span><\/li>").prepend('<span class="line" />').css("left",i*t).appendTo(e),r=f.find("span:not(.line)"),u=r.width()/-2;t==0?u=0:t==l.length-1&&(u=-r.width()),r.css("margin-left",u).addClass("label")});var o=f.height()/a,v=f.height()/(c.length-1),y=n('<ul class="visualize-labels-y"><\/ul>').width(f.width()).height(f.height()).insertBefore(f);n.each(c,function(t){var u=n("<li><span>"+this+"<\/span><\/li>").prepend('<span class="line"  />').css("bottom",v*t).prependTo(y),i=u.find("span:not(.line)"),r=i.height()/-2;t==0?r=-i.height():t==c.length-1&&(r=0),i.css("margin-top",r).addClass("label")}),r.translate(0,b),n.each(s,function(){r.beginPath(),r.lineWidth=u.lineWeight,r.lineJoin="round";var e=this.points,f=0;r.moveTo(0,-(e[0]*o)),n.each(e,function(){r.lineTo(f,-(this*o)),f+=i}),r.strokeStyle=this.color,r.stroke(),t?(r.lineTo(f,0),r.lineTo(0,0),r.closePath(),r.fillStyle=this.color,r.globalAlpha=.3,r.fill(),r.globalAlpha=1):r.closePath()})},area:function(){p.line(!0)},bar:function(){var i,w,t,e,k,y,p,o,v;h.addClass("visualize-bar"),i=f.width()/l.length,w=n('<ul class="visualize-labels-x"><\/ul>').width(f.width()).height(f.height()).insertBefore(f),n.each(l,function(t){var r=n('<li><span class="label">'+this+"<\/span><\/li>").prepend('<span class="line" />').css("left",i*t).width(i).appendTo(w),u=r.find("span.label");u.addClass("label")});var d=f.height()/a,g=f.height()/(c.length-1),nt=n('<ul class="visualize-labels-y"><\/ul>').width(f.width()).height(f.height()).insertBefore(f);for(n.each(c,function(t){var u=n("<li><span>"+this+"<\/span><\/li>").prepend('<span class="line"  />').css("bottom",g*t).prependTo(nt),i=u.find("span:not(.line)"),r=i.height()/-2;t==0?r=-i.height():t==c.length-1&&(r=0),i.css("margin-top",r).addClass("label")}),r.translate(0,b),t=0;t<s.length;t++){for(r.beginPath(),e=(i-u.barGroupMargin*2)/s.length,k=e-u.barMargin*2,r.lineWidth=k,y=s[t].points,p=0,o=0;o<y.length;o++)v=p-u.barGroupMargin+t*e+e/2,v+=u.barGroupMargin*2,r.moveTo(v,0),r.lineTo(v,Math.round(-y[o]*d)),p+=i;r.strokeStyle=s[t].color,r.stroke(),r.closePath()}}},nt=document.createElement("canvas"),f=n(nt).attr({height:u.height,width:u.width}),h=(i||n('<div class="visualize" role="presentation" />')).height(u.height).width(u.width).append(f),o=g(),s=o.dataGroups(),rt=o.allData(),tt=o.dataSum(),w=o.topValue(),ut=o.bottomValue(),it=o.memberTotals(),a=o.totalYRange(),b=u.height*(w/a),l=o.xLabels(),c=o.yLabels();(u.appendTitle||u.appendKey)&&(v=n('<div class="visualize-info"><\/div>').appendTo(h)),u.appendTitle&&(k=u.title||e.find("caption").text(),n('<div class="visualize-title">'+k+"<\/div>").appendTo(v)),u.appendKey&&(y=n('<ul class="visualize-key"><\/ul>'),d=u.parseDirection=="x"?"tr:gt(0) th":"tr:eq(0) th",e.find(d).each(function(t){n('<li><span class="visualize-key-color" style="background: '+s[t].color+'"><\/span><span class="visualize-key-label">'+n(this).text()+"<\/span><\/li>").appendTo(y)}),y.appendTo(v)),i||h.insertAfter(this),typeof G_vmlCanvasManager!="undefined"&&G_vmlCanvasManager.initElement(f[0]),r=f[0].getContext("2d"),p[u.type](),n(".visualize-line li:first-child span.line, .visualize-line li:last-child span.line, .visualize-area li:first-child span.line, .visualize-area li:last-child span.line, .visualize-bar li:first-child span.line,.visualize-bar .visualize-labels-y li:last-child span.line").css("border","none"),i||h.bind("visualizeRefresh",function(){e.visualize(u,n(this).empty())})}).next()}})(jQuery),$(function(){$("table td").click(function(){$(this).is(".input")||$(this).addClass("input").html('<input type="text" value="'+$(this).text()+'" />').find("input").focus().blur(function(){$(this).parent().removeClass("input").html($(this).val()||0),$(".visualize").trigger("visualizeRefresh")})}).hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})});
//@ sourceMappingURL=charts.min.js.map